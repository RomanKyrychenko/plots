library(ggplot2)
library(ggiraph)
library(dplyr)
library(scales)
library(lubridate)
library(grid)
library(ggplot2)
library(ggalt)
library(ggthemes)
library(viridis)
library(stringi)


tooltip_css <- "background-color:transparent;"
gg_path_3 = ggplot(capital2) +
  geom_point_interactive(aes(????, ???????, group=????, data_id = ????,
                                 tooltip = paste(????," \n ????:",????,"\n ?????? ????????:", paste(round(???????,0)/1000, "??? ???")),color = ??????, onclick = ????),size=0.3) +
  geom_path_interactive(aes(????, ???????, group=????, data_id = ????,
                                tooltip = paste(????,"\n",??????), onclick = paste0("https://uk.wikipedia.org/wiki/",????),color = ??????), size = .3) + 
  geom_hline(yintercept = 0, size=0.3) +
  scale_y_continuous(limits=c(-40000000, 31000000), labels = comma) +
  scale_color_manual(values = c("#2b8cbe","#ece7f2")) +
  ylab("") +
  xlab("") +
  labs(title = "?????? ???????? ????????",
       subtitle = "???????? ???????? 2014-2016 ????? \n ? ??????? ???????",
       caption = "???????: ???????????? ???? ???????") +
  theme_bw()+
  theme(legend.position = "bottom",
        legend.box = "horizontal",
        panel.grid.major.y = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_line(colour="grey60", linetype="dotted"), 
        panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_text(size = 6,color = "black"),
        axis.title.y = element_text(margin = margin(r = 20), color = "grey70"),
        axis.title.x = element_text(margin = margin(t = 20), color = "darkslategrey"),
        plot.title = element_text(size = 12, margin = margin(b = 10)),
        plot.subtitle = element_text(size = 8, color = "darkslategrey", margin = margin(b = 25)),
        plot.caption = element_text(size = 6, margin = margin(t = 10), color = "grey70", hjust = 0),
        strip.text = element_text(size = 4, angle = 0),
        strip.background=element_rect(colour = "white", fill="white"),
        text = element_text(family = "Arial"))
ggiraph(code = {print(gg_path_3)}, hover_css = "stroke:#3182bd;stroke-width:3px;", width = 1, height = 5, zoom_max = 4)

gg_path_3 = ggplot(credits2) +
geom_point_interactive(aes(????, ???????, group=????, data_id = ????,
tooltip = paste(????," \n ????:",????,"\n ?????? ????????:", paste(round(???????,0)/1000, "??? ???")), onclick = ????, color = ??????),size=0.3)+
geom_path_interactive(aes(????, ???????, group=????, data_id = ????,
tooltip = paste(????,"\n", ??????), onclick = ????, color = ??????), size = .3)  +
geom_curve(aes(x = dmy("01-04-2015"), y = 120000000, xend = dmy("01-04-2015"), yend = 186000000), size=1,alpha=0.5, curvature = -0.2,arrow = arrow(length = unit(0.25,"cm")))+
geom_curve(aes(x =dmy("01-04-2015"), y = 120000000, xend = dmy("01-04-2015"), yend = 80000000), size=1,alpha=0.5, curvature = 0.2,arrow = arrow(length = unit(0.25,"cm")))+
scale_y_continuous(limits=c(0, 190000000), labels = comma) +
scale_color_manual(values = c("#2b8cbe","#ece7f2")) +
ylab("") +
xlab("") +
labs(title = "??????? ?? ?????????????? ???????? ?? ????????? ????",
subtitle = "???????? ???????? 2014-2016 ????? \n ? ??????? ???????",
caption = "???????: ???????????? ???? ???????") +
theme_bw()+
theme(legend.position = "none",
legend.box = "horizontal",
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_line(colour="grey60", linetype="dotted"), 
panel.border = element_blank(), 
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text = element_text(size = 6,color = "black"),
axis.title.y = element_text(margin = margin(r = 20), color = "grey70"),
axis.title.x = element_text(margin = margin(t = 20), color = "darkslategrey"),
plot.title = element_text(size = 12, margin = margin(b = 10)),
plot.subtitle = element_text(size = 8, color = "darkslategrey", margin = margin(b = 25)),
plot.caption = element_text(size = 6, margin = margin(t = 10), color = "grey70", hjust = 0),
strip.text = element_text(size = 4, angle = 0),
strip.background=element_rect(colour = "white", fill="white"),
text = element_text(family = "Arial")) +
annotate(geom = "text",x = dmy("01-08-2015"), y = 120000000, label="Ï³???????? ???????????? ???????????? \n ?????? ? ??????? ???????? 2015-??",size=1.5,family = "Arial")
ggiraph(code = {print(gg_path_3)}, hover_css = "stroke:#3182bd;stroke-width:3px;", width = 1, height = 5, zoom_max = 4)